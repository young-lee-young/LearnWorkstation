# 镜像配置


### raw VS qcow2

* raw

裸格式，直接作为一个块设备给虚拟机使用，创建就需要指定存储容量，占用全部容量

优点：性能好

缺点：不支持动态扩容，不支持快照


* qcow2（quick copy on write 2）

KVM 支持的磁盘镜像格式，开始只占少许容量

优点：支持动态扩容，支持压缩，支持 AES 加密，支持快照，性能较好


### 创建镜像

```bash
qemu-img create -f qcow2 -o size=20G $image_name.qcow2
```


### 查看镜像信息

```bash
qemu-img info $image_name.qcow2
```


### 镜像转换

```bash
qemu-img convert -O qcow2 $image_name.raw $image_name.qcow2

qemu-img convert -O raw $image_name.qcow2 $image_name.raw
```


### 打包系统文件目录

```bash
tar pczvf os.tgz --exclude=/proc/* --exclude=/lost+found --exclude=/mnt/* --exclude=/sys/* --exclude=/dev/pts/* --exclude=/dev/shm/* --exclude=/var/log/* --exclude=/var/cache/* --exclude=/var/crash/* --exclude=/tmp/* --exclude=/swapfile --exclude=/home/* --exclude=/data/* /
```
