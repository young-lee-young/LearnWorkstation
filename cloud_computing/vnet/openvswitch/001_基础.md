### 基础命令


* 网桥操作

```bash
# 添加网桥
ovs-vsctl add-br br0 -- set Bridge br0 fail-mode=secure

# 查看网桥
ovs-vsctl show
```



* 端口操作

```bash
# 给br0网桥加port
ovs-vsctl add-port br0 p1 -- set Interface p1 ofport_request=1 type=internal

# 开启br0网桥的port
ovs-ofctl mod-port br0 p1 up
```



* 流表操作
  1. priority：优先级，0 - 65535，越大越优先，默认为32768，相同优先级，dump-flows靠前优先

```bash
# table0，br0网桥添加流表，dl为data link缩写，
ovs-ofctl add-flow br0 "table=0, dl_src=01:00:00:00:00:00/01:00:00:00:00:00, actions=drop"

# table0，添加流表，设置优先级为0，将包转发给OpenFlow的table1
ovs-ofctl add-flow br0 "table=0, priority=0, actions=resubmit(,1)"

# table1，设置vlan header
ovs-ofctl add-flow br0 "table=1, priority=99, in_port=2, vlan_tci=0, actions=mod_vlan_vid:20, resubmit(,2)"

# 查看流表
ovs-ofctl dump-flows br0

# 删除br0下所有流表
ovs-ofctl del-flow br0
```



* 测试

```bash
# 进入端口为1，指定目的mac
ovs-appctl ofproto/trace br0 in_port=1,dl_dst=01:80:c2:00:00:10
```

