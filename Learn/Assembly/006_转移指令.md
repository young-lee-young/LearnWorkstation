# 转移指令



不支持直接修改 CS、IP寄存器，如果需要执行某处的指令，可以通过 jmp 跳转到该处



### 跳转指令：jmp

*  同时修改 CS、IP的内容

```assembly
; 用指令中给出的段地址修改 CS，偏移地址修改 IP
jmp 段地址:偏移地址; 

; 实例
jmp 1000:3
```

* 仅修改IP的内容

```assembly
; 使用寄存器的内容修改 IP
jmp 寄存器

; 示例
jmp ax
```



### 段内短转移：jmp short

占用2个字节：jmp short 一个字节，跳转范围一个字节

跳转范围为：-128 - 127，向前转移最多可以转移128个字节，向后转移最多可转移127个字节，使用补码表示

转移计算：jmp 到的位置的偏移地址 - jmp 下一条指令的偏移位置，如果为负数，取补码

```assembly
start:
		jmp short start
		
编译后为：EBFE

1. FE 十六进制转为二进制
1111 1110
2. 减1
1111 1101
3. 各位取反
0000 0010
4. 结果为2，取负数为-2，说明便宜2个字节

; start的偏移地址为0
; jmp 下一条指令位置为2（jmp short start为2个字节）
; 0 - 2 = -2，取补码为 FE

; 所以编译后的机器码为：EB FE，EB 为 jmp short，FE 为 -2，表示向前跳转 2个字节
```



### 段内近转移：jmp near

占用3个字节：

跳转范围为：-32768 - 32767，使用补码表示

转移计算：jmp 到的位置的偏移地址 - jmp 下一条指令的偏移位置，如果为负数，取补码

```assembly
start:
		jmp near start

编译后为：E9FD FF

1. FFFD 十六进制转为二进制
1111 1111 1111 1101
2. 减1
1111 1111 1111 1100
3. 各位取反
0000 0000 0000 0011
4. 结果为3，取负数为-3，说明偏移3个字节
```



### 段间转移：jmp far

一个段最大为64KB，64KB = 2 ^ 6 * 2 ^ 10 = 2 ^ 16

```assembly
jmp far CS:IP
```

```assembly
start:
		jmp far 0x0:0x7c00
```

