# 数据库事务



### 命令

```mysql
# 查看是否是自动提交，默认是自动提交
SHOW VARIABLES LIKE "%autocommit%";

# 关闭自动提交
SET AUTOCOMMIT = 0;

# 开始事务
BEGIN;
START TRANSACTION;

# 提交
COMMIT;
```



### 四个特性

1. 原子性（通过undo log实现）
2. 隔离性（通过锁实现）
3. 一致性（）
4. 持久性（通过redo log和bin log实现）



### MVCC

对读已提交和可重复读有效

两个隐藏列：trx_id（事务ID）、roll_pointer(回滚指针)

每次更新，将旧值记录到undo日志中

可重复读每次读取数据前生成ReadView，在第一次读取数据时生成ReadView

