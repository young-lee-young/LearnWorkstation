# 记录操作


### 插入记录

```sql
INSERT INTO 表名（列名1, 列名2, 列名3) VALUES (值1, 值2, 值3), (值1, 值2, 值3);

INSERT INTO 表名 SET 列名 = 值, 列 = 值, 列 = 值;

INSERT INTO 表名 (列名) SELECT 列名 FROM 表名 WHERE 条件;
```


### 删除记录

```sql
DELETE FROM 表名 WHERE 条件;
```


### 更新记录

```sql
UPDATE 表名 SET 列名 = 值, 列名 = 值 WHERE 条件;

UPDATE 表名 SET 列名 = 列名 + 5 WHERE 条件;
```


### 查询记录 

* 语句的顺序

```sql
SELECT * FROM 表名 WHERE 条件;

# 显示每条记录的详细信息
SELECT * FROM 表名 \G;

# 查询不同一个列的不同值
SELECT DISTINCT 列名 FROM 表名;
```

* 语句顺序

SELECT -> FROM -> WHERE -> GROUP BY -> HAVING -> ORDER BY -> LIMIT

* WHERE比较符

=、<>（不等于）、！=、<、<=、>、>=、BETWEEN AND（在两个值之间，包括开始值和结束值）

* 通配符

```sql
# %匹配任意多的字符
SELECT * FROM 表名 WHERE 列名 LIKE `%匹配内容`;

# _匹配一个字符
SELECT * FROM 表名 WHERE 列名 LIKE `_匹配内容`;
```


### 排序

* 原理

1. 根据 WHERE 等条件查询，生成 "中间结果集"
2. 将 "中间结果集" 放入 sort_buffer
3. 对 "中间结果集" 按照 ORDER 字段排序
4. 回表生成完整结果集（若需要）

* 中间结果集

中间表较小时，直接放在内存中；中间表大于 sort_buffer_size 时，放在硬盘中

若需要优化内存占用，减小 sort_buffer_size；若需要优化排序查询时间，增大 sort_buffer_size

行小于 max_length_for_sort_data 时，生成 "全字段" 中间表；行大于 max_length_for_sort_data 时，只生成 "排序字段 + 主键" 中间表，需要回表


### 分组

```sql
SELECT COUNT(*) FROM 表名 GROUP BY 列名;

SELECT COUNT(*) FROM 表名 GROUP BY 列名 HAVING COUNT(*) > 2;
```
