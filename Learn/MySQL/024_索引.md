# 索引



### 索引命令

```mysql
# 查看索引
SHOW INDEX FROM `table_name`;

# 创建索引
CREATE INDEX index_name ON table_name (column_name);

# 删除索引
DROP INDEX index_name ON table_name;
```



### 未使用索引原因

1. 要查询的数据比例很大时

2. SQL使用了表达式、函数、模糊匹配（%%）、正则表达式

3. 隐式转换（如字符串列使用数字类型做查询条件）

4. NOT IN不走索引

5. IN，如果是单个条件走索引，多个条件不走索引

6. 联合索引没有满足最左匹配原则

   

### 慢查询日志

```mysql
# 查看慢查询是否开启
SHOW VARIABLES LIKE '%slow_query_log%';

# 开启慢查询日志
SET GLOBAL SLOW_QUERY_LOG='ON';

# 查看慢查询时间
SHOW VARIABLES LIKE '%long_query_time%'；

# 设置慢查询时间
SET GLOBAL LONG_QUERY_TIME = 0;
```



### InnoDB索引

* 一级索引：主键索引，聚簇索引，叶子节点既存储主键值也存储数据行
* 二级索引：除主键索引外的其他索引，非聚簇索引，叶子节点存储主键值



回表：需要去一级索引中进行查询数据

覆盖索引：二级索引中有需要查询的字段，不需要进行回表操作



### MyISAM索引

有.myi索引文件、.myd数据文件

* 一级索引：叶子节点key存放索引值，value存储数据的指针，指向数据文件
* 二级索引：和一级索引相同

