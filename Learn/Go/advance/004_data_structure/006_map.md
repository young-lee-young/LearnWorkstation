### map

* map扩容

map溢出桶过多导致严重的性能下降

1. 装载因子超过 6.5（平均每个槽 6.5 个 key）
2. 使用了太多溢出桶（溢出桶超过了普通桶）

* 扩容方法

1. 等量扩容：数据不多但是溢出桶太多（整理数据）
2. 翻倍扩容：数据太多了

* 扩容步骤

step 1

1. 创建一组新桶
2. oldbuckets 指向原有的桶数组
3. buckets 指向新的桶数组
4. map标记为扩容状态

step 2

1. 将所有数据从旧桶驱逐到新桶
2. 采用渐进式驱逐
3. 每次操作一个旧桶时，将旧桶数据驱逐到新桶
4. 读取时不进行驱逐，只判断读取新桶还是旧桶

step 3

1. 所有旧桶驱逐完成后
2. old buckets 回收
