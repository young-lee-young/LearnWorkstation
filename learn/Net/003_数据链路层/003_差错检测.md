# 差错检测


### 基础

* 误码率（BER，Bit Error Rate）

在一段时间内，传输错误的比特占所传输比特总数的比率称为误码率


* 帧检验序列（FCS，Frame Check Sequence）

以太网帧中有 4字节 的 FCS，PPP帧中有 2字节 的 FCS


* 检测方法

1. 奇偶校验
2. 循环冗余校验


### 奇偶校验

* 方法

在待发送数据后面添加1位奇偶校验位，使整个数据（包括所添加的校验位在内）中的 "1" 的个数为奇数（奇校验）或者偶数（偶校验）


* ⚠️问题

校验位本身出错，或发生偶数位错误，奇偶校验失效


### 循环冗余校验（CRC，Cyclic Redundancy Check）

* 方法

1. 收发双方约定好一个生成多项式 G(x)
2. 发送方基于**待发送的数据**和**生成多项式**计算出差错检测码（冗余码），将其添加到待传输数据的后面一起传输
3. 接收方通过**生成多项式**来计算收到的数据是否产生了误码


* 发送过程举例

如：
待发送数据为：101001
生成多项式 G(x) = x^3 + x^2 + 1 = 1 * x^3 + 1 * x^2 + 0 * x^1 + 1 * x^0

1. 构造被除数：待发送信息后面添加生成多项式最高次数个0，被除数为：101001000
2. 构造除数：生成多项式各项系数构成的比特串，除数为：1101
3. 做除法：![除法过程](./image/)，余数为：1
4. 检查余数：余数位数应该与生成多项式最高次数相同，如果位数不够，则在余数前补0来凑足位数，余数为：001
5. 发送：将余数添加到待发送数据的后面，发送数据：101001001


* 接收过程举例

如：
接收到数据为：101101001
生成多项式 G(x) = x^3 + x^2 + 1 = 1 * x^3 + 1 * x^2 + 0 * x^1 + 1 * x^0

1. 构造被除数：接收到的信息就是被除数，被除数为：101101001
2. 构造除数：生成多项式各项系数构成的比特串，除数为：1101
3. 做除法：![除法过程]()，余数为：11
4. 检查余数：余数为0，可认为传输过程无误码，余数不为0，可认为传输过程产生误码


* ⚠️注意

1. 检错码只能检测出帧在传输过程中出现了差错，不能定位错误，因此无法纠错
2. 要想纠正传输中的差错，可以使用冗余信息更多的**纠错码**进行前向纠错。但纠错码的开销较大，很少使用
3. CRC 有很好的检测能力（漏检率非常低），虽然计算比较复杂，但非常易于用硬件实现，因此被广泛用于数据链路层
