# iptables 动作


### 基础

* 语法

```bash
iptables [-t 表名] 操作命令 [链名] [匹配条件] [-j 目标动作或跳转]
```


### ACCEPT

* 作用：接收数据包

* 示例

```bash
# 🌰：允许所有数据包通过
iptables -t filter -A INPUT -j ACCEPT
```


### DROP

* 作用：丢弃数据包，无响应包

[DROP 无响应包](image/004_DROP.png)

* 示例

```bash
iptables -t filter -A INPUT -s 192.168.0.1 -j DROP
```


### REJECT

* 作用：拒绝数据包，有响应包

[REJECT 有响应包](image/005_REJECT.png)

* 示例

```bash
iptables -t filter -A INPUT -s 192.168.0.1 j REJECT
```


### SNAT

* 作用：源地址转换，SNAT 支持转换为'单 IP'，也支持转换到 'IP 地址池'

* 示例

```bash
# 🌰：将内网 192.168.1.0/24 的源地址修改为 1.1.1.1，用于 NAT
iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j SNAT --to 1.1.1.1

# 🌰：将内网 192.168.1.0/24 的源地址修改为 1.1.1.1 - 1.1.1.10
iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -j SNAT --to 1.1.1.1-1.1.1.10
```


### DNAT

* 作用：目的地址转换，DNAT 支持转换为'单 IP'，也支持转换到 'IP 地址池'

* 示例

```bash
# 🌰：将从 eth0 进来的要访问 TCP/80 的数据包的目的地址改为 192.168.0.1
iptables -t nat -A PREROUTING -i eth0 -tcp -p tcp --dport 80 -j DNAT --to 192.168.0.1
```


### MASQUERADE

* 作用：动态源地址转换（动态 IP 地址的情况下使用，如 ADSL）

* 示例

```bash
# 🌰：将源地址是 192.168.1.0/24 的数据包进行地址伪装，转换为 eth0 上的 IP 地址，eth0 为路由器外网出口 IP 地址
iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE
```
