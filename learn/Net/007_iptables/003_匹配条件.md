# iptables 匹配条件


### 基础

* 语法

```bash
iptables [-t 表名] 操作命令 [链名] [匹配条件] [-j 目标动作或跳转]
```


### 按网络接口匹配

-i：匹配数据进入的网络接口

-o：匹配数据流出的网路接口

* 示例

```bash
# 🌰：匹配从 eth0 口来的数据包
iptables -t filter -A INPUT -i eth0 -j DROP
```


### 按照地址匹配

-s：匹配数据来源地址

-d：匹配数据目的地址

* 示例

```bash
# 🌰：匹配 IP 地址
iptables -t filter -A INPUT -s 192.168.0.1 -j DROP

# 🌰：匹配网段
iptables -t filter -A INPUT -s 192.168.1.0/24 -j DROP

# 🌰：匹配域名
iptables -t filter -A INPUT -d www.baidu.com -j DROP
```

* 注意⚠️

地址可以是 IP 地址、网段、域名


### 按照协议匹配

-p：匹配协议类型

* 示例

```bash
# 🌰：匹配 tcp
iptables -t filter -A INPUT -p tcp -j DROP

# 🌰：匹配 udp
iptables -t filter -A INPUT -p udp -j DROP

# 🌰：匹配 ICMP，type 8（ping），type 0（pong）
iptables -t filter -A INPUT -p icmp --icmp-type 8
```


### 按源、目的端口匹配

--sport：匹配源端口

--dport：匹配目的端口

* 示例

```bash
# 🌰：匹配源端口 1000 的端口
iptables -t filter -A INPUT -p tcp --sport 1000 -j DROP

# 🌰：匹配源端口 1000-3000 端口
iptables -t filter -A INPUT -p tcp --sport 1000:3000 -j DROP

# 🌰：匹配目的端口 >= 1000（含 1000）端口
iptables -t filter -A INPUT -p tcp --dport 1000: -j DROP

# 🌰：匹配目的端口 <= 3000（含 3000）端口
iptables -t filter -A INPUT -p tcp --dport :3000 -j DROP
```

* 注意⚠️

--sport 和 --dport 必须配合 -p 参数使用
