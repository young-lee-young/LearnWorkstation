# 存储过程


### 基础

* 存储过程的定义

存储过程是SQL语句和控制语句的预编译集合，以一个名称存储并作为一个单元处理

* 存储过程的优点

1. 增强SQL语句的功能和灵活性
2. 实现较快的执行速度
3. 较少网络流量

* 存储过程和自定义函数的区别

1. 存储过程实现功能复杂一些，函数的针对性更强
2. 存储过程可以返回多个值，函数只能返回一个值
3. 存储过程一般独立的来执行，函数可以作为其他SQL语句的组成部分出现


### 存储过程使用

* 过程体

1. 合法的SQL语句构成
2. 过程体可以是任意的SQL语句
3. 如果为复合结构使用BEGIN...END语句
4. 复合结构可以声明变量，循环语句，控制结构

* 创建存储过程

```sql
# 声明结束符
DELIMITER $$

# 删除用户并返回剩余用户个数
CREATE PROCEDURE deleteReturnNum(IN user_id int, OUT use_num int)
BEGIN
	DELETE FROM user WHERE id = user_id;
	SELECT COUNT(*) FROM user INTO use_num;
END$$

# 将结束符更改为;
DELIMITER ;
```

* 更新存储过程

```sql
ALTER PROCEDURE;
```

* 删除存储过程

```sql
DROP PROCEDURE IF EXISTS 存储过程名称;
```

* 调用存储过程

```
CALL 过程存储名称;
```
