# 约束


### 约束类型

* 非空约束（NOT NULL, 只有列级约束）

```mysql
# 如果为 OFF，在创建表时的 NOT NULL 是没有用的
SHOW VARIABLES LIKE '%innodb_strict_mode%';
```

* 主键约束（PRIMARY KEY）

1. 每张表只有一个主键
2. 保证记录唯一性
3. 主键自动为NOT NULL

* 唯一约束（UNIQUE KEY）

1. 可以有多个唯一约束
2. 保证记录唯一性
3. 唯一约束的字段可以为NULL

* 默认约束（DEFAULT, 只有列级约束）

* 外键约束

1. 父表（被指向的表）和子表（有外键列的表）存储引擎必须是InnoDB
2. 外键列和参照列数据类型必须相同（数字长度和是否有符号必须相同，字符长度可以不同）
3. 外键列和参照列必须创建索引（MySQL会自动对主键列和外键列创建索引）

备注：外键不一定是另一个表的主键，但是一定是唯一性索引（具有主键约束或唯一约束）


### 外键约束的参照操作

* 创建子表时

```sql
列名 类型 ON DELETE/UPDATE 操作（CASCADE, SET NULL, RESTRICT, NO ACTION）;
```

1. CASCADE, 父表删除时，子表相应的记录同时删除，父表更新时，子表相应更新
2. SET NULL, 父表删除或更新时，子表对应的外键设置为NULL
3. RESTRICT, 拒绝对父表进行删除或更新操作
4. NO ACTION, 与RESTRICT相同


### 约束添加与删除

* 主键约束

```sql
# 添加
ALTER TABLE 表名 ADD [CONSTRAINT 自定义约束名] PRIMARY KEY [索引类型] (列名);

# 删除
ALTER TABLE 表名 DROP PRIMARY KEY;
```

* 添加唯一约束

```sql
# 添加
ALTER TABLE 表名 ADD [CONSTRAINT 自定义约束名] UNIQUE KEY [索引类型] (列名);

# 删除
ALTER TABLE 表名 DROP INDEX 约束名字;
```

* 添加外键约束

```sql
# 添加
ALTER TABLE 表名 ADD [CONSTRAINT 自定义约束名] FOREIGN KEY [索引类型] REFERENCES 父表名(列名);

# 删除
ALTER TABLE 表名 DROP FOREIGN KEY 约束名字;
```

* 添加默认约束

```sql
# 添加
ALTER TABLE 表名 ALTER 列名 SET DEFAULT 默认值;

# 删除
ALTER TABLE 表名 ATLER 列名 DROP DEFAULT;
```